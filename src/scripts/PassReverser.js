class PassReverser {
	/**
	 * @param {object} diffused diffusion dictionary
	 */
	constructor(diffused) {
		const json_raw = atob(diffused)
		const dictionary = JSON.parse(json_raw)

		this.diffused = dictionary
	}

	Reverse(input) {
		let reversed = ""

		let counters = {}
		const keys = Object.keys(this.diffused)
		for (let cnt = 0; cnt < keys.length; cnt++) {
			counters[keys[cnt]] = 0
		}

		for (let cnt = 0; cnt < input.length; cnt++) {
			let char = input[cnt]

			//avoid error
			if (counters[char] >= this.diffused[char].length) {
				counters[char] = 0
			}

			let adding = this.diffused[char][counters[char]]
			counters[char] += 1

			reversed += adding
		}

		return reversed
	}
}

const passReverser = new PassReverser(
	//hard code open key
	"eyIwIjpbIkV4TUtzQUQiLCI4VmRHcXJMIiwieDBGYThsaiIsImw2b0RrUWwiLCJ1czJWZGZIIl0sIjEiOlsiM1lFYllucSIsIkhjTlE5U3EiLCJLazJXV085IiwiZDM2T0FPTSIsIm1icDZJbzUiXSwiMiI6WyI1YmpMVDZsa24iLCJkSGdLUHlKIiwid094aDNQSiIsIjlkdTlpQjkiLCJxVWdoekVkIl0sIjMiOlsicXp6OTh2SCIsIkZOcEgyaTQiLCJJRXoxZjZTIiwiTlNKQ3Z6ciIsInd5MGpXbzMiXSwiNCI6WyJMWkdCSlBNIiwidTVwOHVUVCIsIkJ4M2Z4N2siLCJsNzZxc0VGIiwiZ3pYbjhDQyJdLCI1IjpbIlNhQnhyNGwiLCI4eHVjc2VxIiwiRTBJd2ZJbSIsIjJLNVVDT3ciLCJiN3E5WGZTIl0sIjYiOlsiRG90Z1M4cSIsIkk2cWVmZEYiLCIzS0ZITENvIiwiRjF5bFdiVCIsIlhTbTRkem4iXSwiNyI6WyI3Wk9aRUoyIiwiUGVJUEZVaiIsInA5OGd0b0YiLCI1NW1JT08xIiwibWVYaEFsdiJdLCI4IjpbIjFudjl6VWoiLCJKWEh1UElGIiwiR25OOUlITCIsIlBIQ0VaRzkiLCI3SmJWb3FqIl0sIjkiOlsiWUlneGI3ZiIsIjBOYnZ5MzciLCJyYUs2ZmlPIiwiRDJFWGJvdCIsIkJRM2hkNDciXSwiYSI6WyJZSTRISkEwIiwiQnE3MGRfQSIsInk0STNMOTUiLCJTbW5qbHNTU1kiLCJIQ24xc0NnRzkiXSwiYiI6WyJHeTlaMHJIIiwiOWRlV3d6WSIsIjJTdmdaR2oiLCJGUllBQml0IiwiYjl4VG1idiJdLCJjIjpbIkNKMjFMRXEiLCJTUTV1VlBuIiwiWExMeWs1VCIsImhja2JTdFYiLCJ5UGpNbm9IIl0sImQiOlsicGF0XzExQSIsIk83R1N5Vm9LWiIsImQ1cTFtTnYiLCJOTUlLeDRSIiwiSEN6V1ZEZCJdLCJlIjpbIkIwbGV6RHkiLCJ1ZHhEZ1c2Iiwid3VRcU8xdiIsIkZESDFTOHMiLCJsU0hHREZjIl0sImYiOlsiM1hhY1YxcyIsImlpSHNBc1EiLCJxREMzV3BxIiwid0RnQjI4NyIsImlyUFg3eDQiXSwiZyI6WyJhZmgzSlZnIiwidEpUaVlZWiIsIm00RnNVajAiLCI4TGN4cXp6Iiwic3NFdEZVNSJdLCJoIjpbIlRuczE3YXAiLCJmVlBBOGdIIiwiNml2TVowYiIsImJmQXkwVFciLCJwdHpXamVlIl0sImkiOlsiMTkwTzFpcSIsIkpWemlwdWwiLCJCSXltbzI0IiwiMXU0bkpUeCIsIjd4N1ZGZnciXSwiaiI6WyJhNjA2RWJsIiwic3BlT3lFTSIsIkhYbHVtbjkiLCJyZ01XNHFJIiwiWmFYdzEwYyJdLCJrIjpbIm1Hc1hiYnEiLCJ3cHZHT2FOIiwiUXQ2YmFkayIsIm9UVTdrV1YiLCJ4T21BUWpFIl0sImwiOlsiMWxOYkpWWSIsIkZtQzdpd04iLCJxSFdDMlVWIiwiaUtYRDFzSSIsInZ3TmswZTciXSwibSI6WyJNTmdmM2IxIiwic2VUdVF2dnJsIiwidUZnV1lqVyIsImxCV1ZmOTIiLCJjdEhtVU1XIl0sIm4iOlsiZ0JycXRPYSIsIkpTRGZEN2YiLCIyalN5eU8xIiwidUFpZ1ozNCIsInc3R25iTW0iXSwibyI6WyJmQ1AxREowIiwiSGM4bnIzdSIsImpURmZpZkYiLCJWZzBLcm41IiwiaFlXeGE5eiJdLCJwIjpbInoxOTdhY3IiLCJpcmRJNnlrIiwiekVseE5jMyIsIjIzT2o0dkYiLCJTbmh3c1NLIl0sInEiOlsiSlpWM0RCaiIsInY5YU8ycmgiLCJEQVUzSHc5IiwiblpmbW83QyIsImpvdnJqUjEiXSwiciI6WyJzbFhSY0FKIiwicUpQREc1ciIsImRBOVQ3bHgiLCJjeHFEU0E3IiwiU3VwMW13dSJdLCJzIjpbImdiU0ZaSm0iLCJpOWpiVWxPIiwiSlpCN2hsWSIsIkR1em1ZS2siLCJ6TkRlWDJyIl0sInQiOlsieVhIeXFTWiIsIk1QSXVuR1oiLCJjbjNPamtxIiwieTVvTFhTcyIsImVZR0s2djEiXSwidSI6WyJwcUVWVHZvIiwiTnNwMWs2RCIsIjMyNzJyaW0iLCJwZ2J6bjMzIiwiNFVKWWU0VCJdLCJ2IjpbIkZ5VGdYNFIiLCJzSlc5WjE2Iiwib3JGeE43NCIsInU5ZEx3SHkiLCIydVpIUjlsIl0sInciOlsiUGxRdVJNaCIsIjY2VUNlR3ciLCJYTXRTY3VSIiwiMDhENnFDYyIsImEyNFJaY00iXSwieCI6WyJJejA4NGRVIiwiWXVGdUhPWCIsImNvV0l0QzkiLCJZNm91RG9BIiwiQVhrTTJiYiJdLCJ5IjpbInFWdnAyTkgiLCJSM3c4RVRFIiwiRm54SjhQYiIsIjhwTUVJYzciLCJFODViSDdOIl0sInoiOlsiZHFLR1NzVCIsIjhkMERoNm8iLCJKa01DRFVkIiwiVUJGU0VXeiIsIkxPTlBNNFgiXSwiQSI6WyJGNTllRzZYIiwiU3M3Zlc3cyIsInpRSnNjSmYiLCJNZXlUZHl4IiwialZZaUxXNSJdLCJCIjpbIlM5d3JPTUYiLCJOYkZCN2RqIiwiTU5PbHdIMyIsIno3aW1NRksiLCJKV1RGOW0wIl0sIkMiOlsiUjBDOFVBciIsIlg2YkxxbWMiLCJtVEdIU2pIIiwiN2k2TW00SCIsIlVNNFBzVDMiXSwiRCI6WyJycG1iYmFFIiwiZmFLR0lXNyIsIlllVXRBZGQiLCJaU25oZWx4IiwieDhCUlhVeCJdLCJFIjpbIkpsUGlJRzgiLCJwdFlwUnpEIiwiamtLTXc1UCIsInhmZmY5U0QiLCJzOFNzVmxLIl0sIkYiOlsid3BzYnZRRCIsIk1qMkhkeDAiLCJxak14ejJGIiwiVFpXbDJuUiIsIjg2ZnVJWVIiXSwiRyI6WyJVTDU2b2lsIiwidWxTeTdNWSIsImZiR0psdW8iLCJtUzZqQUh2IiwiY2ZXZEhwYSJdLCJIIjpbIjlYeXBvS0QiLCIzV3ZlS1BrIiwiWHhSYjg1YyIsIkl6NkhVYWYiLCJVU3d2dlduIl0sIkkiOlsiNE9PdERaNiIsIjlNQ0s3MzAiLCJDU2VEVlJMIiwicEtDcWZxUyIsImpDVWY3T3ciXSwiSiI6WyI4VVJjVEUxIiwiTG1CZ1RmNSIsIjF1Vk14TmoiLCJKeFhtSlhWIiwiSlIyRlFUMSJdLCJLIjpbIlZ6dTM1S28iLCJic1RGTXhyIiwiWXlxekNIUiIsIk1DMWNOazQiLCJ2a2ZJbjdQIl0sIkwiOlsiQ3d3YjV2cyIsImNHNnUxQmEiLCJUZkIwSWdvIiwiZDlMbkRORCIsIjZGQkF5amgiXSwiTSI6WyJTZnZTNFY2IiwiaEMzajVybiIsInFTOGhqSWYiLCJxWlE0TGw1IiwiajkydkhmTCJdLCJOIjpbInFmUkJXclEiLCI5c0lTWU0xIiwiTnFPVFU1VyIsIk9jbUhBcHkiLCJ0eWt4U2xjIl0sIk8iOlsiR2lnYWxNaSIsIkZrVWJEZjIiLCI0eG55RnhEIiwiSzZjVXhIViIsInVhY1VBZnoiXSwiUCI6WyJpMmJmSkJUIiwicHlLRzBVNyIsIlZYQXZnZWgiLCJ0Y3JXY3pIIiwibjN2Y1A4NiJdLCJRIjpbIlRRRkpEZ1IiLCIxcmJBM3ZYIiwiVWFlTVpkYiIsIm9CcjhWWkQiLCJqeUFjTkMzIl0sIlIiOlsicTIzVWh0MyIsIkdhakEyU04iLCJaRjdwNjBRIiwiR290NWtJSyIsInVGWk5sNnUiXSwiUyI6WyIxNU53QWpoIiwiVDFtRk5EMyIsIlYzUDNQTEUiLCI2WXR5N05FIiwieWtvbkFINSJdLCJUIjpbInV4Nk1Uc3giLCJTM1d6eEttIiwiMEtJWExWTiIsInJibmxuTlciLCJUVnduUk9LIl0sIlUiOlsiZ2l0aHViXyIsIjJiZU5JbWRXNyIsIk9Fa2IxN0UiLCJ2bHlEVUgwIiwiMGZ3U2dSSSJdLCJWIjpbIjQ4bWJ4VlEiLCJzT0VBN0w0IiwiTWtKeDNvTiIsIlhhRWNJRUciLCJwU2lxRXNVIl0sIlciOlsiVUNhNkpYSiIsIlBudkxzZHoiLCJNQUxNaVRZIiwiamg2OXltNyIsIjlaSFJMd0kiXSwiWCI6WyIyem1nbkJDIiwiVHdyV2d3OCIsIjRGbnFrZGYiLCI3c2pybXdIIiwiTUhZb0E1RyJdLCJZIjpbIjNhQ3pVQ3IiLCJ3NDhra0Z4IiwiS1A4MGR3YiIsInhWc3NVVzciLCIwcnBhYTFtIl0sIloiOlsiM2haSmdaZyIsIkdqMTJBZlkiLCJYdkZvb0ZmIiwidk1IYmQzcCIsIkszeGdoMEsiXX0=",
)
