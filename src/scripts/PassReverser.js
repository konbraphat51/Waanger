class PassReverser {
	/**
	 * @param {object} diffused diffusion dictionary
	 */
	constructor(diffused) {
		const json_raw = atob(diffused)
		const dictionary = JSON.parse(json_raw)

		this.diffused = dictionary
	}

	Reverse(input) {
		let reversed = ""

		let counters = {}
		const keys = Object.keys(this.diffused)
		for (let cnt = 0; cnt < keys.length; cnt++) {
			counters[keys[cnt]] = 0
		}

		for (let cnt = 0; cnt < input.length; cnt++) {
			let char = input[cnt]

			//avoid error
			if (counters[char] >= this.diffused[char].length) {
				counters[char] = 0
			}

			let adding = this.diffused[char][counters[char]]
			counters[char] += 1

			reversed += adding
		}

		return reversed
	}
}

const passReverser = new PassReverser(
	//hard code open key
	"eyIwIjpbIkhWS280QjkiLCJaUzR2UFRiIiwiN3kxN1VGQSIsIkpDTzBMVDkiLCJ6UDJWUXRMIl0sIjEiOlsiQmN5SDRBOSIsImk0T1JZeW4iLCI5TjUzUGY3IiwiNE41WGRubyIsIlhwU0dvOTQiXSwiMiI6WyJWMGltd0tDNHgiLCJpaTU1aEd4IiwiQk5keXRTMyIsIlhkcldZMlgiLCJSSW1rUjNqIl0sIjMiOlsia1RWTllGYyIsInpiVVBJTXEiLCJCSjVGMDJZIiwiY0NuVFBKeCIsInptNlB1RFoiXSwiNCI6WyJJTU5WSlVFIiwibWZ4MGE5WSIsIm9OdVZDNWwiLCJJSXgyMVVDIiwiQk9tR2pBMiJdLCI1IjpbIlZTQTBXdkEiLCJib0NqdTNBIiwibUNwSTc2YiIsImdMZmpkVm8iLCJ6QUlNRnRlIl0sIjYiOlsiZWRJaUtPSSIsIklNaVlxU1AiLCJqa1pHeHkyIiwiOTFHTlhpaSIsIlBQaDE2YkIiXSwiNyI6WyIxU0lseUgwIiwiSXl3T3FIViIsIkVKMFBVNWsiLCJZY1Jaam90IiwieXlqTnh1ciJdLCI4IjpbImN5aTByZFIiLCI4RlVUWEt2IiwiTlVrS0xJNSIsIkNLV3JsREYiLCJpTGxRMFNKIl0sIjkiOlsiZTMxWUFyeCIsIjNPemtiekIiLCJFUUZPMzdvIiwid282MndDSyIsImtRaHBpUWgiXSwiYSI6WyJZSTRISkEwIiwiVkRpRjlfeSIsIjFaV3l6Z2IiLCJwMExGRnA2dUQiLCJIQ2c2NlVMTHciXSwiYiI6WyJadWMwTW8xIiwiWnpxMFA2VyIsIkRWSEh5dTYiLCI0OGhhck1PIiwiQ215VGExRiJdLCJjIjpbInFuT0QyREMiLCJka0F2bXBzIiwiclBaMjVvcSIsImlHYlhtS0QiLCJLaW90ZklqIl0sImQiOlsicGF0XzExQSIsIkdsT2s5OThKeiIsIlk3YkNObjIiLCI4Z0JQak9DIiwiS2RnZTVxUiJdLCJlIjpbInoyN0xBam4iLCJiUjFHQkxsIiwicEc2bUlPOSIsInE1QkxxZG0iLCJJb0dCNmJiIl0sImYiOlsiZ2trN2NpayIsImdRMTI3N1oiLCJGUnJhZEJFIiwiWFlIU1NNTSIsIktNU0RiUmkiXSwiZyI6WyJIUVQ3c0x0IiwiUG85cFhQVSIsImZaUFlib0wiLCJjN0pCVXZHIiwiaWZsRkJDeCJdLCJoIjpbIjVyUGRlWk0iLCI1SldXNHN0IiwiREM4ek5rUCIsIllGcm8ybnYiLCJIdjhybEdoIl0sImkiOlsibFBEZllZWCIsIjRJU0JjbEQiLCJVUHduTnRVIiwiUmQzd2tNYSIsIlpCamhLN2IiXSwiaiI6WyI1N1FnZWZvIiwiZjVja0t0dSIsIjFhaXlmSU8iLCJqZ0JYMU5aIiwibVpNY2xpTiJdLCJrIjpbIjYwWnhqaFgiLCJMY0FxQkhRIiwiUmhYVG5qTSIsIjdQSHYzdzciLCJHcHF2cTU4Il0sImwiOlsiZm1VR2xWeSIsIkRqeHVGa1ciLCJEZVk1ZW9HIiwiWlRsdk9BWCIsIjl0bVN3WW0iXSwibSI6WyJCQ3JBc0lTIiwiS0RCNm1FSElBIiwibXVHRGZOcCIsImJWMUpTQmsiLCI2N0lha2J3Il0sIm4iOlsiMDhOaFlwZSIsIjV5MU5Pb2MiLCIxUlVqSFlWIiwiN1FPbVVnYiIsIldaS1V6VDQiXSwibyI6WyJPSVhNdkdiIiwieEJqMDV2UyIsIjZvbHV2T2EiLCJ2aWxtQXFiIiwiTEJRNkZ3eCJdLCJwIjpbIkNXUEhMZlciLCJOTXdVUENXIiwibzgxWlh2ZiIsIlc0eHlzWlMiLCJBN3o3TTd3Il0sInEiOlsiNm85V2RneSIsIlpuRkZhZ2UiLCJaZGRNNjhhIiwiY2xyQUhUWSIsIjgwcFhpVG4iXSwiciI6WyJQc2JVM1cxIiwiM1hiMkwwSSIsImFrSUVOQlQiLCJFUHByNnhnIiwiVUFPbERtRSJdLCJzIjpbImpBcUI2bUMiLCJGNUFQMmhQIiwiU1hRSG1WcSIsImZzdHpzSTEiLCJrOVFieWdiIl0sInQiOlsid1VJVDRheCIsInVaWVY3SVciLCJkNmVhMzBpIiwiQ3A2Z1NUVyIsImtJcDdvNTgiXSwidSI6WyI2dTVNZ0NvIiwiRUlRVldRcyIsIk5UcXc5Y3UiLCJxYW5aZ3FIIiwiR1VqWWRjYyJdLCJ2IjpbIkFBdUtraHYiLCJBTGxzMTdjIiwiWjNMS2d2ayIsInZ6bnVpUjIiLCJMa3dKbHVUIl0sInciOlsiSkJ5UVdRSyIsInAzS2V1S0kiLCJtT2ZCRldWIiwiNFZEM0JhSiIsInNQNjNDSlciXSwieCI6WyJwS1ZtcXhUIiwiZ0t0aG1xcSIsInF1NjdIVlciLCJ3SllNa2ZNIiwiUTRqdU5kSCJdLCJ5IjpbIkptYnpGSVoiLCJ0ZWw2ZDEwIiwiVUtVdG1CbCIsIlJIWVhOZGYiLCJpanJCVVZ3Il0sInoiOlsibGYwV05sVSIsIlF2b2xFdWkiLCJuWDFNSEN2IiwiTzlMRmQ1WCIsImgzaVRGVjMiXSwiQSI6WyJ0bHRST1BmIiwiSmt6SDF3SyIsInFnR01nODciLCJSUHVTcVJ2IiwiWUU5d3N2dyJdLCJCIjpbInNQQ2VoT1MiLCJ6amtqSFFZIiwiblB4SUVmTCIsIjhTdEpRalgiLCJJS0g2ZTV2Il0sIkMiOlsidGtUQ1pwMCIsImVteEtJUHciLCJRM0RzMlc4IiwiYThoaERFSyIsIkEzWlVZMmwiXSwiRCI6WyIza1RZRlRVIiwibUdWU2pSeSIsImdaeG5FWW8iLCJBbklQM2hNIiwiNXNwWHFEdSJdLCJFIjpbIlc5RXdzalAiLCJVdDlRT0JWIiwiRXdIcnZlNyIsIm9Iekh2aTkiLCJmSTJLOXJYIl0sIkYiOlsiOGg3dzN0OSIsImdqVFBYNTkiLCJidVFzZUJLIiwib3A2Zm1kQiIsIm9SVHRSb2wiXSwiRyI6WyJjZzdPNHpqIiwiWWwzQUlXUSIsImxWQ3A4MHYiLCJWbURRWjRyIiwiaU5wRlpOMiJdLCJIIjpbIjZXQ1BYT0ciLCJQWTN6ZFZIIiwiQm8yNmNUSiIsIjRIa3RuQU8iLCJRWWtkVnd2Il0sIkkiOlsiUkJmZFdxdSIsIk5Yazd4YTciLCJ3eXdMZERnIiwiU2JUOThvZyIsImpyRHZibEUiXSwiSiI6WyJNeXNreVZHIiwiaHBwRDN5RyIsIkF1dGFoMEciLCIzSGI5V0xNIiwidU8wSUpGYyJdLCJLIjpbInFNQ09BYzQiLCJGM2t4VTExIiwiTHNlWkxKNyIsInZaenZPT0UiLCJ3M1lCVG5wIl0sIkwiOlsiNkdZc2h1SyIsIkFQY2NSeTkiLCJBUmladmpMIiwieTd5OUttbSIsIkxIV0hMbVYiXSwiTSI6WyJpMjNmeEpCIiwiellKRTZZdSIsIk8xcndTVEUiLCJlUFlTTjdJIiwiY2R5TnBKWSJdLCJOIjpbImZUZXJrblIiLCJoaWpaM3BGIiwicFNzbVdNWCIsImNKRXdVdkMiLCJVM0ZOUDVQIl0sIk8iOlsiWkM2dXF2OSIsIjBmUWJ2dU0iLCJ4bTZsSGVuIiwiU1VWNTFQTSIsIlZySU01UlAiXSwiUCI6WyI5ZXNJTzFsIiwiVlFGWVFZTSIsIlkzaXVZNEciLCJHMktjYVB0IiwibGJ5RlN5WCJdLCJRIjpbIlg4T05iaXgiLCJBNTI0b1R3IiwiclpENGZ4YSIsIlhzeDhKa2QiLCJDdW9xcG9oIl0sIlIiOlsiWkRYS0dFbCIsIllJcllreFUiLCJSNHZVNWRhIiwiWkxLdFZRYiIsInFwNlptQlciXSwiUyI6WyJvamJEVmJRIiwiZHoyQ2s3SCIsIm1pM3NXTUwiLCJtNGVaWWQ4IiwidVpOSlc2RCJdLCJUIjpbIm1wcFFYWEgiLCJsRXNRNGdvIiwialdHa1V2eSIsIkNSUkJGazkiLCIybFd0MWF6Il0sIlUiOlsiZ2l0aHViXyIsInpscG9vVWNMbCIsInNBN2ZhcGQiLCJLNVdwOTNIIiwiT3NCR1paYSJdLCJWIjpbIkZGb1RUUm0iLCI4bHRUT2paIiwiNEl0UDVWOCIsIjhHNVJKMjUiLCJQR0NPT0kzIl0sIlciOlsiem1oTjRCUyIsIkhuSlFlcmsiLCJ5UjZERVpNIiwiVDUwdnhMZCIsIkVTdUhZMUwiXSwiWCI6WyIySTBUQnlaIiwic0RCeVdhUiIsImRZMUJSR20iLCJmZXdkaWJoIiwiQkppOFlocSJdLCJZIjpbIkJrdnNiR20iLCJITk5vT2lMIiwiNk9kM2E3VCIsIkZRS0MyTk0iLCJwRDJVVVBWIl0sIloiOlsiN3pLM2lQViIsImdSWkFGaEUiLCJnMllTVHcxIiwiOTBodVJKSSIsIjNCYjFwUnUiXX0=",
)
