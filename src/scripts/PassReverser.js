class PassReverser {
	/**
	 * @param {object} diffused diffusion dictionary
	 */
	constructor(diffused) {
		const json_raw = atob(diffused)
		const dictionary = JSON.parse(json_raw)

		this.diffused = dictionary
	}

	Reverse(input) {
		let reversed = ""

		let counters = {}
		const keys = Object.keys(this.diffused)
		for (let cnt = 0; cnt < keys.length; cnt++) {
			counters[keys[cnt]] = 0
		}

		for (let cnt = 0; cnt < input.length; cnt++) {
			let char = input[cnt]

			//avoid error
			if (counters[char] >= this.diffused[char].length) {
				counters[char] = 0
			}

			let adding = this.diffused[char][counters[char]]
			counters[char] += 1

			reversed += adding
		}

		return reversed
	}
}

const passReverser = new PassReverser(
	//hard code open key
	"eyIwIjpbImFyYjlHWCIsInNhbmtNYyIsIlNyb0t4OCIsIkczRmoxTiIsInBjV2JkZiJdLCIxIjpbInliTjFrbiIsIlpjcEFCUiIsIk5qb1BxRCIsIm45T0RxYiIsIkJnWXdvWiJdLCIyIjpbIlAyV3U0ZUZKUWwiLCJuaHJWYXYiLCJod25RYWciLCJsS3FsNkIiLCJCeDd2bU0iXSwiMyI6WyJOazIxeG8iLCJYck9IZkwiLCIzbnNMQ08iLCJDQU9OUlMiLCJxTzZsaVIiXSwiNCI6WyJISFE3UEYiLCJLVVNtaVYiLCJpaGJDTTUiLCI4M1BvcW4iLCJoZ0VmS3oiXSwiNSI6WyJyNGFubVAiLCJSWnZhUEsiLCJWOE1TWW8iLCJiZWViUG4iLCJubnVGc2wiXSwiNiI6WyJlcUp1ZFQiLCJvVE1ybVEiLCJVT2IyRmwiLCJkTjRTZ0MiLCJIU3RQbFciXSwiNyI6WyJJbGxQS1IiLCJJVENwMTgiLCJHbUYyWlgiLCJFemVRdlkiLCJFdHZ3ZWwiXSwiOCI6WyJsUDNPN08iLCJSbENMbFUiLCJtZ2I2emoiLCJMMVZyZEsiLCI5T3FNWkIiXSwiOSI6WyJUOXZ4RnkiLCI2eWFweFgiLCJ3d05ITmYiLCJmbEplUVoiLCJOT2hoZVAiXSwiYSI6WyJzMmZaTTMiLCJOT2diblUiLCJKV1FJRDAiLCJFell5WkRwNXRMIiwiM29Cb0o4cDdvUCJdLCJiIjpbInBHeFo4RCIsInBsRk1sMSIsIlQwOXpFWiIsInZTS0ltZSIsImVsRzZkZSJdLCJjIjpbIlRVOE80WCIsIjU0MmpMeCIsIjF3Skt3YiIsInE4TWhGdSIsInN3TXVQNSJdLCJkIjpbIkhKQTA1cyIsInJTc1dNbmtXNW8iLCJQOU5mZnYiLCJsZDFoYUwiLCJzV0ROcTMiXSwiZSI6WyJwTXN3a0ciLCJMOVhOcXAiLCJlOGRyMUUiLCJZM3pYc0kiLCJpWlZrOWsiXSwiZiI6WyJRZmZaMzkiLCI2MDJYOEQiLCJLOHlPaDMiLCJLWHNVcUMiLCJ3NGxKUGYiXSwiZyI6WyJBUXJMUVUiLCJKbTY3MksiLCJPNVBUdDYiLCI5eUplT0MiLCJqRXlyVDAiXSwiaCI6WyI2Q3J1MG0iLCJhaFE3V3kiLCJpeFppMWMiLCJzMkY3UlkiLCJ5MXRvaW0iXSwiaSI6WyJPb3lobHkiLCJwMmdVRzMiLCJrNXpUSmciLCI4R2Y3ZWQiLCIyUk1xb3kiXSwiaiI6WyJUSmhYQnkiLCJMaXZGaDgiLCJMVVhSajUiLCJCSXIxcVoiLCJZeDJhQWgiXSwiayI6WyJ4SjY4blMiLCJhNEtvcmEiLCI3NEU3OEkiLCJIZUxxV0ciLCI4UnVyTXciXSwibCI6WyJHMnJxUUoiLCJBVk8xYkciLCJjWHAxSE4iLCJXMG1XSHciLCJ2Qm9NM1EiXSwibSI6WyJwVTFKX0QiLCJrNDhudk5ENHZVIiwiSmZEb1ZqIiwiTURmbzBUIiwiN2FiY0NxIl0sIm4iOlsiVG8wbG5BIiwiRGJXWFBoIiwiM0RVVldJIiwiTHlLTFdNIiwiY1VQa3hQIl0sIm8iOlsiN1VpOTZxIiwiV1pTQkFaIiwiRGxXOHcxIiwib2FDbzNUIiwiNXhKSEdLIl0sInAiOlsiaEl2d3ptIiwia3VnZEVXIiwiWm9iNlRLIiwiSm0zRFpUIiwiSWc3RmdYIl0sInEiOlsiNHB4TFBDIiwiZ3picnlyIiwiZklUYjBtIiwiazBtcVk5IiwiTTlLMnhtIl0sInIiOlsiSjQwaUdYIiwiWEFvc1JBIiwiendMNUg2IiwibUlXWDhuIiwiV2J4TzFEIl0sInMiOlsib1JTaXhGIiwiR3VvUXYxIiwibVJ6VFpXIiwidWxKa25LIiwiZmVGVWVCIl0sInQiOlsiR2cyYk9IIiwiNzZMaWFlIiwiRnpyTXprIiwiSlU2ZmtPIiwiMENKU1ZuIl0sInUiOlsiTkdIOUY1IiwidjczMEozIiwiSDh5WWd4IiwiZDZDRjRoIiwieDFjbk9YIl0sInYiOlsiY3JQcHpmIiwibE5jQWR0IiwiUUpIUVNVIiwiUHc2TDRoIiwiWmVvbGxRIl0sInciOlsiWEw3a1UyIiwiQlNhYXQyIiwiSEZQU0JjIiwicm05NW0yIiwiUlJKNVJqIl0sIngiOlsidThtTThTIiwicGNRN1hSIiwicHJnRnowIiwiVmVJbU9lIiwiYkNOSzV0Il0sInkiOlsiYzVWeTMzIiwiM3pCMGoxIiwiOGFUYW1CIiwiZmF2Y3FDIiwiNTR6NGlKIl0sInoiOlsiS1NZU2pWIiwiNXFURTlRIiwiMllwZkVyIiwiWklISk9zIiwiejJYMEpjIl0sIkEiOlsiUmh4QXR2IiwiQXhPdUhaIiwiNVFvZ2hzIiwiNndiMGRXIiwiUm9CSExIIl0sIkIiOlsieGw2V01yIiwiNUpxWkFPIiwic2FQYWxiIiwiNVZvVzJWIiwiVTRJZ1pYIl0sIkMiOlsidEdLZkQ0IiwiWEx6RTR1IiwiT0lzV3NWIiwiT2lmdFdlIiwiZUI1b0wzIl0sIkQiOlsiWFN5TGtGIiwidmRCQ0Z5IiwidFJONTlMIiwiNjVMa1FIIiwiUTBMRk5FIl0sIkUiOlsianJEdTBSIiwiM1Z3blJ6IiwiSTdFS3drIiwiQUM5N3htIiwibnpRNDY0Il0sIkYiOlsiQWJDRFo0IiwidjFEa3FNIiwiSWpNeGFJIiwiZFg5dXQxIiwiN2xZNnA5Il0sIkciOlsibmtoNlhyIiwiVVdyY2d3IiwidlJyaHhaIiwiRjdkMHlEIiwiT2hyVmVaIl0sIkgiOlsiSllIZHlCIiwiYnJJVUFXIiwibTRSQmZRIiwiRTZpdDNNIiwibkFXMnpyIl0sIkkiOlsiOU5jQVhTIiwid3MwTHY5IiwidjV6V0R2IiwiTlFpb2lKIiwiUW1MdFc3Il0sIkoiOlsiM3Nsek92IiwiSkI2MVh6IiwiWjBjQ1B0IiwiSFpzUjhGIiwiNU9RVGFnIl0sIksiOlsiOHVmVG1qIiwiZEttcWc4IiwiblowWGIzIiwiQ3I0TVMxIiwiMVV0VGxIIl0sIkwiOlsiYXFXN3lxIiwiZFNPZEhkIiwiRkgzVkhBIiwicHNad2pLIiwiS29VYTZLIl0sIk0iOlsickdCZnhsIiwiOUhGYW1RIiwic0k4RW5OIiwiclVHcWJQIiwicHhrQ2RHIl0sIk4iOlsiOXRVUm5LIiwiS2Fxc3dPIiwiRnlnRTZKIiwiYUFuVnc5IiwiWmxyaW56Il0sIk8iOlsicXIyTk4yIiwiUjVvSXdmIiwiMjQ1cmE4IiwieG1heGpCIiwiNDh6WGZDIl0sIlAiOlsiOW9JRUQ4IiwiT0RRYnV0IiwiQms1SkFCIiwibjFBSUJLIiwiZXpqRXE1Il0sIlEiOlsiTURJcTB5Iiwic1RGRWxCIiwiUEdBMW5aIiwiNWdyb3NmIiwidVhRRnBHIl0sIlIiOlsiYnk3a1NBIiwiaVQwSlVRIiwielJMc3FVIiwiamljRVdHIiwiZUlyRDloIl0sIlMiOlsieGFUdFJ6IiwiU2s2TDlYIiwiWVFkUm55IiwiMEduTzZRIiwiYTZabmtPIl0sIlQiOlsiVW1DajlaIiwiWlZCYUVSIiwiUDBrODFQIiwiTXBNMm1uIiwiR1VrU1FYIl0sIlUiOlsiMTFBWUk0IiwiUU43b2ViZXBINCIsImdvUnBXTiIsImtJNjFGMiIsIk9KUzR6MiJdLCJWIjpbIlU1dm8wVSIsImk0a1M4NSIsIjdxNTRtZCIsIkVWQk1HdyIsIm5ocnhsbCJdLCJXIjpbIndqNGdDQiIsIlVKdDExeCIsIjlVSm5zOSIsIldmT2U4UiIsInpKNGxSRCJdLCJYIjpbIjJKV0w1TiIsIlFPbzFXUCIsIjJsOUZPdyIsIkpiZFBwZyIsInNTRkNWZSJdLCJZIjpbIjJWVkppUCIsIjAxUUNQbCIsIkFqUDd2bSIsInk5NHZnMiIsIjAzclFLayJdLCJaIjpbIlI0ZDFIVCIsIjBVZ1VmNSIsImRQSEVZaSIsIjE5Q3c0WiIsIlppTGVSeiJdfQ=="
)
