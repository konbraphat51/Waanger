class PassReverser {
	/**
	 * @param {object} diffused diffusion dictionary
	 */
	constructor(diffused) {
		const json_raw = atob(diffused)
		const dictionary = JSON.parse(json_raw)

		this.diffused = dictionary
	}

	Reverse(input) {
		let reversed = ""

		let counters = {}
		const keys = Object.keys(this.diffused)
		for (let cnt = 0; cnt < keys.length; cnt++) {
			counters[keys[cnt]] = 0
		}

		for (let cnt = 0; cnt < input.length; cnt++) {
			let char = input[cnt]

			//avoid error
			if (counters[char] >= this.diffused[char].length) {
				counters[char] = 0
			}

			let adding = this.diffused[char][counters[char]]
			counters[char] += 1

			reversed += adding
		}

		return reversed
	}
}

const passReverser = new PassReverser(
	//hard code open key
	"eyIwIjpbIkpwZDZRbyIsImRDaHNiRyIsInZEcjJnNCIsImhId2VtbiIsIjd6YVdrUSJdLCIxIjpbIm5RajM5aCIsIlRHbXZNWCIsIktLc2RXdSIsImlGRUF5WiIsIjZDRjJadSJdLCIyIjpbInY2bzZUWSIsImN6YjVmZSIsIlZBQ3I2eSIsIjBCS0NnRCIsIkFaSzdRWSJdLCIzIjpbIlFNN2tMQiIsIjExNkJEYiIsImY1MGh5WiIsInA4NFJqcCIsIm9XU1k1aCJdLCI0IjpbIjJHWFpaUVNKUVJMWWZhRUciLCJnYzlmcTYiLCJiUHAyQVAiLCJYZ3FObkYiLCJqcmY2S3MiXSwiNSI6WyJPYnBWRTUiLCJuOUpyN2UiLCJlSXhSTzYiLCJKZjdqTTUiLCJBTm1YaHMiXSwiNiI6WyJ2RnlJcngiLCJocDdnTmsiLCJWOWNJVVoiLCJURDhKMVkiLCIxVTFNd3QiXSwiNyI6WyJmSXV5NTkiLCJyUmk3WmMiLCJzaDhqZ1ciLCJZbjlaWEIiLCI4dFpueGciXSwiOCI6WyJYTjZaQ1oiLCIxYW43amYiLCJ4SWhtT3kiLCJOT2V5b3giLCJTbE9yWTMiXSwiOSI6WyJvNHVWeloiLCJSMUZWWjkiLCJoM1VyaWgiLCJQOVVYSFAiLCJCZHJBSVIiXSwiYSI6WyJRTTVDcEwiLCI4T2lEblciLCJBT1laczUiLCIyM21xTTJqRFJyWmFHV1NVIiwidmxQd1pwOFdNRWMzU0ppbiJdLCJiIjpbIjJ2SGtoTiIsIlFVbW12TCIsImxiNHhzZCIsInZMREFWTiIsIlFSakphNyJdLCJjIjpbIjlCTTV3cCIsIlc3eVpMdCIsInBpWHZxTCIsIjljYlFIaCIsIkY3MENScyJdLCJkIjpbIkhKQTB5UiIsIkl6Z0NObktYbUI1UDJYVEQiLCJDQUdvZnQiLCIwdG9sV00iLCJKMFVHSkQiXSwiZSI6WyI3dmFSWmIiLCI2Z2ZaU1MiLCJIbEJxYUkiLCJ5V09mblAiLCJzTHRNbmEiXSwiZiI6WyI3TmVGRHoiLCI3aFFkMkEiLCJQZnQxbEUiLCJacDNXTm0iLCJXR0FCZ3QiXSwiZyI6WyJpZU8yWGYiLCJXd3dzcTYiLCJ3dHBHRVkiLCJmWGlqWWkiLCJVckd1VFEiXSwiaCI6WyJXZDBxMU0iLCJLOHQ2WHAiLCI0eXZhMXMiLCI0MlFqbzEiLCJLVE5XSGsiXSwiaSI6WyI1WERJbHYiLCJmUXpxdlIiLCJRRVhBZUkiLCJadWZ1cjIiLCJxMzJITjgiXSwiaiI6WyI5RXZvTjkiLCJ3U2FNZloiLCJrOXhhZ2ciLCJPd09YZWUiLCJYRzNRQXciXSwiayI6WyJGYkx3VGYiLCIyYzBXdnUiLCJ6S1VZU1QiLCJZa3Nya00iLCJxZ3ByV24iXSwibCI6WyJrTnlaalkiLCJmR1dpNVYiLCJ1NEtyOEciLCJrR1NGOVUiLCJ0WGpuQUkiXSwibSI6WyJDN0R3X0UiLCJxQVVCNk9OUEg2YzFVajNEIiwiNjU3NDN5IiwiWjJvdk9lIiwiSG1CZG4wIl0sIm4iOlsiZFdCMFZqIiwiQzZjZ3RUIiwiaGJhRTJzIiwiVXB6Y3NIIiwiUGN2dDBCIl0sIm8iOlsieWNsRjdQIiwiN3FlNkZlIiwiOWJ6eDJnIiwiUEpUbUVKIiwiQlAxaGkwIl0sInAiOlsiaWtVekplIiwiZEhTMVFhIiwiSTFYN3J6IiwiUVZES1p3IiwiM0VRZlVXIl0sInEiOlsiTzd6aE1BIiwidDQ1alpkIiwiUUJEOGpKIiwiTWZvWWxmIiwiWGcwY3ljIl0sInIiOlsidVpObTdqIiwiNGNGZlVHIiwiU2RpZW42IiwiNjNhRUNCIiwiMFhaMU1hIl0sInMiOlsiVVFsQ053IiwiY3pKNTdCIiwid0tDcmFrIiwicEZhN3BBIiwiYm9zd3VRIl0sInQiOlsiM1JDc1cwIiwiblhNY0ZWIiwiWFl5YnJCIiwiZkw2QjEyIiwielNpSTVZIl0sInUiOlsiY25rbkVMIiwiM0Y4VzdLIiwiaWZTNXk1IiwiZFVxdzRBIiwiSHpYb0FiIl0sInYiOlsiMzdOWXJVIiwicWhObEwwIiwiNERQa3RYIiwicXpHMFBmIiwiZzR4VWxxIl0sInciOlsicE5McHFjIiwiSjZ4ZXVwIiwiQUYxNkVZIiwiUWdoalFkIiwiYnM3eDl3Il0sIngiOlsiVFUyd1BKIiwiV1NuMHp4IiwibG5tZDdwIiwiaUw5Z1VoIiwiY20ybDJtIl0sInkiOlsiR3o5VFFsIiwiNWY4ME5DIiwiOFJvTTVzIiwiQjlOUnVIIiwiMldHQmJTIl0sInoiOlsiVGtYM3RlIiwidWhmclBDIiwiZHZzY2VWIiwiMmhTRHJwIiwiTHZybkJ2Il0sIkEiOlsidjRBbWRxIiwid2xXY1RsIiwibG9SekFiIiwiRm1jZUxQIiwiV0NOc1NsIl0sIkIiOlsiMDBBRVFSIiwiZHFNNkR3IiwiaDBCcVFrIiwieElXWFR2IiwiQndyUUpVIl0sIkMiOlsiOTR1TkpiIiwiVDN3c0FWIiwid1ZYUkdCIiwiSWFYSU1RIiwiRWRHRkJoIl0sIkQiOlsiN3Q4MEpwIiwicE1TUk1MIiwiZzA4MVZNIiwiaUJqZFhGIiwiQ3F3dXFEIl0sIkUiOlsiNTlYZVhNIiwicmNaSHlMIiwiNFR6TVJJIiwiNXlFNjNKIiwieDgzTWcxIl0sIkYiOlsiMGhCZ1Z6IiwibXl0TWhDIiwiUHBXTXYyIiwiZ0lKQWVJIiwielNmUHp1Il0sIkciOlsiNmZqNW5lIiwibDZOc0c3IiwiY251NjVYIiwiNmtjUlhjIiwiZTJlSGoyIl0sIkgiOlsiRnFzRVVSIiwiNVFLenRnIiwidlc4TmNpIiwiN3l2U1NoIiwiUUlKR1gxIl0sIkkiOlsiMUExN0liIiwiTlJPUE1KIiwiV3p1ZE5MIiwiTXBMR0I0IiwiUGlsZWFZIl0sIkoiOlsidHQydmxWIiwiUzNYR2VOIiwiN1h1QkEyIiwiTVRrMWh0IiwiZm1YTG5PIl0sIksiOlsiUnlGaGhqIiwieUhoUjR6Iiwidkg5c1hYIiwidUt0N2ozIiwiWUpYNXFyIl0sIkwiOlsiQWhKWDl6IiwiN3NIRG03IiwiQThwNnVRIiwiVjBUUXlPIiwiVjRBc1RVIl0sIk0iOlsiOUxQRzU1IiwiN1F1SUNLIiwidExNNUtKIiwiUDFjR2lyIiwiOWhPUmlOIl0sIk4iOlsiYk9xa1F2IiwiYjRlZEk2IiwidWFmZFlOIiwiOW5POGxjIiwiODl3bHZ3Il0sIk8iOlsiUFE2clRBIiwid1psZjVaIiwiUTg5eXJQIiwiZ0EwSUxOIiwiQUdyWnZOIl0sIlAiOlsidldMcmhaIiwiUzZhWEVhIiwia1RtVTZDIiwiMUZsUVZ4IiwiNTZ4N2ZQIl0sIlEiOlsiWFZRQjR2IiwiUG1FNjlqIiwid3pmV0owIiwieW1nM09lIiwiR3FWSkplIl0sIlIiOlsiaHhTU1hwIiwiTXBqRlQwIiwiSTJjTUxwIiwiREVkSGhEIiwiUGxrNGx0Il0sIlMiOlsiZzU2dFBMIiwiNXo1VkxJIiwidTM2engxIiwibTU1Rlc5IiwieUlRZVBtIl0sIlQiOlsiMTVUVGdnIiwieHNqbWxwIiwieGY4MlZGIiwiRGJvclBMIiwiMWlub3pDIl0sIlUiOlsiMTFBWUk0IiwiaGlsNTNpa3FtNkdzSGFEOCIsIjBha2k2aSIsIjlGeEJTMyIsIm56WTJlOSJdLCJWIjpbIjhnNWJhdiIsImUyTDBqZSIsIjJ0eTA5RSIsIlVHU0RqZiIsIlNXdDFrTCJdLCJXIjpbIlJkdHZvMiIsImZEamxQZCIsInBhTDM2SyIsIkNXTEhkQyIsImdvdzh1SCJdLCJYIjpbIlVFNFZCTyIsImlPU0s1byIsIlRqNXVvTyIsIllWWEJpOCIsIktkN0FyRyJdLCJZIjpbImdRMUNlNiIsImt3MEFMQyIsImhQRWlpVCIsIkNYS3ZiZCIsIlpPWXl1OCJdLCJaIjpbIjhFNUg3NyIsImlaT3RLaiIsIjdMbG1jdiIsImlieHFJQiIsIk1RZFh4MCJdfQ==",
)
